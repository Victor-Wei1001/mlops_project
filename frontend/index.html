<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EN → ZH Translator</title>
  <style>
    body { font-family: sans-serif; max-width: 900px; margin: 40px auto; padding: 0 16px; }
    textarea { width: 100%; height: 140px; padding: 12px; font-size: 16px; }
    button { padding: 10px 16px; font-size: 16px; cursor: pointer; }
    .row { margin: 16px 0; }
    .box { border: 1px solid #ddd; border-radius: 8px; padding: 12px; background: #fafafa; }
    .muted { color: #666; font-size: 14px; }
    pre { white-space: pre-wrap; word-wrap: break-word; }
  </style>
</head>
<body>
  <h1>English → Chinese Translator</h1>
  <p class="muted">Frontend (M26) calling FastAPI backend (M22). Make sure FastAPI is running on <code>http://127.0.0.1:8000</code>.</p>

  <div class="row">
    <label for="inp"><b>English input</b></label>
    <textarea id="inp" placeholder="Type an English sentence...">I love studying in Denmark, but the winter is challenging.</textarea>
  </div>

  <div class="row">
    <button id="btn">Translate</button>
    <span id="status" class="muted"></span>
  </div>

  <div class="row box">
    <b>Chinese output</b>
    <pre id="out">(result will appear here)</pre>
    <div id="meta" class="muted"></div>
  </div>

<script>
const API_BASE = "http://127.0.0.1:8000";

async function translate() {
  const text = document.getElementById("inp").value;
  const status = document.getElementById("status");
  const out = document.getElementById("out");
  const meta = document.getElementById("meta");

  status.textContent = "Translating...";
  out.textContent = "";
  meta.textContent = "";

  try {
    const res = await fetch(`${API_BASE}/predict`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ text, max_new_tokens: 64 })
    });

    const data = await res.json();
    if (!res.ok) throw new Error(JSON.stringify(data));

    out.textContent = data.translation;
    meta.textContent = `model=${data.model_name}, finetuned=${data.used_finetuned_weights}`;
    status.textContent = "Done.";
  } catch (err) {
    status.textContent = "Error.";
    out.textContent = String(err);
  }
}

document.getElementById("btn").addEventListener("click", translate);
</script>
</body>
</html>
